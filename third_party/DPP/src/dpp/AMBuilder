# vim: sts=2 ts=8 sw=2 tw=99 et ft=python:
import os

builder.SetBuildFolder('DPP')

rvalue = {}
for cxx in builder.targets:
  binary = Extension.StaticLibrary(builder, cxx, 'DPP')
  if binary.compiler.target.platform == 'linux':
    binary.compiler.includes += [
      os.path.join(builder.sourcePath, 'third_party', 'DPP', 'include'),
    ]

  binary.compiler.defines += [
  ]
  
  # from DPP CMakeLists.txt
  binary.sources += [
    'socketengines/epoll.cpp',
    'utility.cpp',
    'message.cpp',
    'zlibcontext.cpp',
    'wsclient.cpp',
    'cluster/message.cpp',
    'cluster/confirmation.cpp',
    'cluster/thread.cpp',
    'cluster/role.cpp',
    'cluster/channel.cpp',
    'cluster/json_interface.cpp',
    'cluster/user.cpp',
    'cluster/invite.cpp',
    'cluster/entitlement.cpp',
    'cluster/guild_member.cpp',
    'cluster/appcommand.cpp',
    'cluster/sticker.cpp',
    'cluster/timer.cpp',
    'cluster/emoji.cpp',
    'cluster/automod.cpp',
    'cluster/template.cpp',
    'cluster/webhook.cpp',
    'cluster/guild.cpp',
    'cluster/sku.cpp',
    'cluster/dm.cpp',
    'cluster/gateway.cpp',
    'cluster/stage_instance.cpp',
    'cluster/scheduled_event.cpp',
    'cluster/voice.cpp',
    'queues.cpp',
    'snowflake.cpp',
    'cluster.cpp',
    'thread.cpp',
    'role.cpp',
    'dns.cpp',
    'presence.cpp',
    'integration.cpp',
    'channel.cpp',
    'user.cpp',
    'ban.cpp',
    'http_server.cpp',
    'invite.cpp',
    'entitlement.cpp',
    'auditlog.cpp',
    'dispatcher.cpp',
    'application.cpp',
    'prune.cpp',
    'discordevents.cpp',
    'ssl_context.cpp',
    'emoji.cpp',
    'cache.cpp',
    'automod.cpp',
    'permissions.cpp',
    'webhook.cpp',
    'commandhandler.cpp',
    'guild.cpp',
    'dtemplate.cpp',
    'socketengine.cpp',
    'bignum.cpp',
    'etf.cpp',
    'httpsclient.cpp',
    'sku.cpp',
    'slashcommand.cpp',
    'thread_pool.cpp',
    'signature_verifier.cpp',
    'http_server_request.cpp',
    'discordclient.cpp',
		'discordvoiceclient.cpp',
    'socket.cpp',
    'sslconnection.cpp',
    'discord_webhook_server.cpp',
    'stage_instance.cpp',
    'events/automod_rule_update.cpp',
    'events/guild_scheduled_event_delete.cpp',
    'events/entitlement_update.cpp',
    'events/guild_role_update.cpp',
    'events/thread_delete.cpp',
    'events/guild_members_chunk.cpp',
    'events/channel_pins_update.cpp',
    'events/guild_audit_log_entry_create.cpp',
    'events/guild_create.cpp',
    'events/message_poll_vote_add.cpp',
    'events/stage_instance_update.cpp',
    'events/guild_member_remove.cpp',
    'events/webhooks_update.cpp',
    'events/guild_join_request_delete.cpp',
    'events/stage_instance_delete.cpp',
    'events/integration_update.cpp',
    'events/stage_instance_create.cpp',
    'events/thread_list_sync.cpp',
    'events/channel_update.cpp',
    'events/invite_create.cpp',
    'events/message_create.cpp',
    'events/guild_ban_remove.cpp',
    'events/message_reaction_remove.cpp',
    'events/thread_update.cpp',
    'events/integration_delete.cpp',
    'events/guild_ban_add.cpp',
    'events/ready.cpp',
    'events/interaction_create.cpp',
    'events/guild_scheduled_event_create.cpp',
    'events/thread_create.cpp',
    'events/user_update.cpp',
    'events/guild_scheduled_event_update.cpp',
    'events/resumed.cpp',
    'events/guild_scheduled_event_user_remove.cpp',
    'events/integration_create.cpp',
    'events/automod_rule_delete.cpp',
    'events/thread_member_update.cpp',
    'events/automod_rule_execute.cpp',
    'events/presence_update.cpp',
    'events/guild_emojis_update.cpp',
    'events/channel_create.cpp',
    'events/automod_rule_create.cpp',
    'events/guild_delete.cpp',
    'events/message_update.cpp',
    'events/guild_update.cpp',
    'events/invite_delete.cpp',
    'events/guild_role_delete.cpp',
    'events/guild_member_update.cpp',
    'events/guild_stickers_update.cpp',
    'events/message_reaction_remove_emoji.cpp',
    'events/guild_member_add.cpp',
    'events/entitlement_create.cpp',
    'events/message_reaction_add.cpp',
    'events/guild_role_create.cpp',
    'events/entitlement_delete.cpp',
    'events/guild_integrations_update.cpp',
    'events/message_delete_bulk.cpp',
    'events/guild_scheduled_event_user_add.cpp',
    'events/message_delete.cpp',
    'events/typing_start.cpp',
    'events/message_reaction_remove_all.cpp',
    'events/channel_delete.cpp',
    'events/message_poll_vote_remove.cpp',
    'events/thread_members_update.cpp',
    'events/logger.cpp',
    'events/voice_server_update.cpp',
    'events/voice_state_update.cpp',
    'voiceregion.cpp',
    'voicestate.cpp',
    'voice/stub/stubs.cpp',
    'scheduled_event.cpp',
    # coroutines require C++20 - currently not enabling this feature
    #'cluster_coro_calls.cpp',
  ]

  rvalue[binary.compiler.target.arch] = builder.Add(binary)
